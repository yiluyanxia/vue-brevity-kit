import{P as ie}from"./PageHeader-a1a5681d.js";import{u as se,r as de}from"./regexp-0a157ec9.js";import{g as re,f as ue,j as A,k as me}from"./tool-e1301be4.js";import{u as pe}from"./layout-ad4859fc.js";import{V as ve,X as ce}from"./index-2193c281.js";import{d as fe,f as N,r as _e,g as ge,ab as p,e,a,F as c,b as r,o as s,u as f,ad as R,x as _,c as y,ah as h,af as I,ac as C,ag as xe}from"./runtime-core.esm-bundler-e1893df6.js";import{P as be}from"./UpOutlined-c02615f6.js";import{d as q}from"./LoadingOutlined-377d3aaa.js";import"./vue-router-3d96c2fa.js";import"./ReloadOutlined-8f39c8a7.js";import"./AntdIcon-ea494017.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./index-d60ffb08.js";import"./axios-641c6ca9.js";import"./index-71333aae.js";import"./useConfigInject-985b36a0.js";import"./extends-34e645d9.js";import"./runtime-dom.esm-bundler-d15a3063.js";import"./CloseCircleFilled-f172dba6.js";import"./key-3b961902.js";import"./inherits-1b1b5999.js";import"./variablesCSS-e22db411.js";import"./setting-b9ced7ae.js";import"./UserOutlined-cf9a456f.js";import"./lock-31147f4a.js";import"./StarOutlined-4c117a0a.js";import"./SyncOutlined-15adee8e.js";import"./ClearOutlined-61968c2b.js";import"./RotateRightOutlined-80c84fe8.js";import"./SaveOutlined-0f0d91c1.js";import"./MinusCircleFilled-e71cdf93.js";import"./SignalFilled-a7fff856.js";const ye=C("div",{class:"brevity-advanced-form-footer-left"},null,-1),ke={class:"brevity-advanced-form-footer-right"},he={class:"brevity-advanced-form-footer-warn-content"},na=fe({__name:"AdvancedForm",setup(Ie){const M=pe(),L={id:"",name:"",pid:null,userName:"",hash:"",tag:"",engine:"",min:void 0,max:void 0,securities:[{algorithm:"",mode:"",padding:"",privateKey:""}],visitorList:[{id:"0",name:"Alice",account:"alice",type:1},{id:"1",name:"Bob",account:"bob",type:1}]},l=N(L),{id:D,formRef:F,getInfo:Se,getQuery:V,goBack:Ue,onFinish:B}=se({formState:l,initialState:L}),T=[{value:"SM3",label:"SM3"},{value:"MD5",label:"MD5"},{value:"SHA1",label:"SHA1"},{value:"SHA256",label:"SHA256"}],z=[{value:"2D",label:"2D"},{value:"3D",label:"3D"}],H=[{value:"SM4",label:"SM4"},{value:"AES",label:"AES"},{value:"DES",label:"DES"}],K={name:[{required:!0,message:"请输入名称"}],pid:[{required:!0,message:"请输入 PID"},{pattern:de.number,message:"PID 仅支持数字"},{min:3,max:10,message:"PID 长度为3-10位字符"}],userName:[{required:!0,message:"请输入用户名"}]},$=()=>{l.securities.push({algorithm:"",mode:"",padding:"",privateKey:""})},Y=i=>{let n=l.securities.indexOf(i);n!==-1&&l.securities.splice(n,1)},j=[{title:"姓名",dataIndex:"name",width:120},{title:"账号",dataIndex:"account",width:120},{title:"类型",dataIndex:"type",width:120},{title:"操作",key:"action",width:100}],v=N({}),Q=()=>{const i=(l.visitorList.length+1).toString();l.visitorList.push({id:i,name:"",account:"",type:null}),v[i]={id:i,name:"",account:"",type:null}},X=i=>{v[i]=me(l.visitorList.filter(n=>i===n.id)[0])},G=(i,n)=>{var u;(u=F.value)==null||u.validateFields([["visitorList",n,"name"],["visitorList",n,"account"],["visitorList",n,"type"]]).then(()=>{delete v[i]}).catch(d=>{console.log("error",d)})},J=(i,n)=>{v[i].type?Object.assign(l.visitorList.filter(u=>i===u.id)[0],v[i]):delete l.visitorList[n],delete v[i]},S=_e([]),W=({errorFields:i})=>{console.log("errorFields",i),S.value=i},Z=()=>{S.value=[],B(D?"updateList":"createList")};return ge(()=>{V()}),(i,n)=>{const u=r("a-input"),d=r("a-form-item"),m=r("a-col"),U=r("a-select"),O=r("a-input-number"),P=r("a-row"),w=r("a-card"),x=r("a-button"),E=r("a-divider"),ee=r("a-tag"),ae=r("a-table"),te=r("a-list-item"),le=r("a-list"),ne=r("a-popover"),oe=r("a-form");return s(),p(c,null,[e(ie,{back:!1}),e(oe,{class:"brevity-advanced-form-box",ref_key:"formRef",ref:F,model:l,rules:K,"label-col":{xs:4,sm:6,md:8},"wrapper-col":{xs:20,sm:18,md:16},autocomplete:"off",onFinish:Z,onFinishFailed:W},{default:a(()=>[e(w,{bordered:!1,title:"基础数据",class:"mb24"},{default:a(()=>[e(P,null,{default:a(()=>[e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"名称",name:"name"},{default:a(()=>[e(u,{value:l.name,"onUpdate:value":n[0]||(n[0]=t=>l.name=t)},null,8,["value"])]),_:1})]),_:1}),e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"PID",name:"pid"},{default:a(()=>[e(u,{value:l.pid,"onUpdate:value":n[1]||(n[1]=t=>l.pid=t),disabled:f(re)(f(D))},null,8,["value","disabled"])]),_:1})]),_:1}),e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"用户名",name:"userName"},{default:a(()=>[e(u,{value:l.userName,"onUpdate:value":n[2]||(n[2]=t=>l.userName=t)},null,8,["value"])]),_:1})]),_:1}),e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"标签",name:"tag"},{default:a(()=>[e(u,{value:l.tag,"onUpdate:value":n[3]||(n[3]=t=>l.tag=t)},null,8,["value"])]),_:1})]),_:1}),e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"哈希",name:"hash"},{default:a(()=>[e(U,{value:l.hash,"onUpdate:value":n[4]||(n[4]=t=>l.hash=t),options:T},null,8,["value"])]),_:1})]),_:1}),e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"引擎",name:"engine"},{default:a(()=>[e(U,{value:l.engine,"onUpdate:value":n[5]||(n[5]=t=>l.engine=t),options:z},null,8,["value"])]),_:1})]),_:1}),e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"最小值",name:"min"},{default:a(()=>[e(O,{value:l.min,"onUpdate:value":n[6]||(n[6]=t=>l.min=t),min:1,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"最大值",name:"max"},{default:a(()=>[e(O,{value:l.max,"onUpdate:value":n[7]||(n[7]=t=>l.max=t),min:1,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{bordered:!1,title:"安全配置",class:"mb24"},{default:a(()=>[(s(!0),p(c,null,R(l.securities,(t,g)=>(s(),p(c,{key:g},[e(E,{orientation:"right","orientation-margin":"0px"},{default:a(()=>[_(" 安全组"+h(g+1)+" ",1),e(x,{danger:"",type:"text",onClick:o=>Y(t),disabled:l.securities.length===1},{icon:a(()=>[e(f(ce))]),_:2},1032,["onClick","disabled"])]),_:2},1024),e(P,null,{default:a(()=>[e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"算法",name:["securities",g,"algorithm"],rules:{required:!0,message:"请选择算法",trigger:"change"}},{default:a(()=>[e(U,{value:t.algorithm,"onUpdate:value":o=>t.algorithm=o,options:H},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"模式",name:["securities",g,"mode"],rules:{required:!0,message:"请输入模式",trigger:"change"}},{default:a(()=>[e(u,{value:t.mode,"onUpdate:value":o=>t.mode=o},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"填充",name:"padding"},{default:a(()=>[e(u,{value:t.padding,"onUpdate:value":o=>t.padding=o},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024),e(m,{xs:24,sm:24,md:12,lg:12,xl:8,xxl:6},{default:a(()=>[e(d,{label:"密钥",name:"privateKey"},{default:a(()=>[e(u,{value:t.privateKey,"onUpdate:value":o=>t.privateKey=o},null,8,["value","onUpdate:value"])]),_:2},1024)]),_:2},1024)]),_:2},1024)],64))),128)),e(E,{dashed:"",class:"pt24"},{default:a(()=>[e(x,{onClick:$},{icon:a(()=>[e(f(ve))]),default:a(()=>[_(" 添加安全组 ")]),_:1})]),_:1})]),_:1}),e(w,{bordered:!1,title:"访客名单"},{default:a(()=>[e(ae,{columns:j,"data-source":l.visitorList,scroll:{x:"100%"},pagination:!1},{bodyCell:a(({column:t,text:g,record:o,index:k})=>[t.dataIndex==="name"?(s(),p(c,{key:0},[v[o.id]?(s(),y(d,{key:0,name:["visitorList",k,t.dataIndex],rules:{required:!0,message:"请输入姓名",trigger:"change"}},{default:a(()=>[e(u,{value:o[t.dataIndex],"onUpdate:value":b=>o[t.dataIndex]=b},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])):(s(),p(c,{key:1},[_(h(g),1)],64))],64)):I("",!0),t.dataIndex==="account"?(s(),p(c,{key:1},[v[o.id]?(s(),y(d,{key:0,name:["visitorList",k,t.dataIndex],rules:{required:!0,message:"请输入账号",trigger:"change"}},{default:a(()=>[e(u,{value:o[t.dataIndex],"onUpdate:value":b=>o[t.dataIndex]=b},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])):(s(),p(c,{key:1},[_(h(g),1)],64))],64)):I("",!0),t.dataIndex==="type"?(s(),p(c,{key:2},[v[o.id]?(s(),y(d,{key:0,name:["visitorList",k,t.dataIndex],rules:{required:!0,message:"请选择类型",trigger:"change"}},{default:a(()=>[v[o.id]?(s(),y(U,{key:0,value:o[t.dataIndex],"onUpdate:value":b=>o[t.dataIndex]=b,options:f(ue)("VISITOR_TYPE"),style:{width:"100%"}},null,8,["value","onUpdate:value","options"])):I("",!0)]),_:2},1032,["name"])):(s(),y(ee,{key:1,color:f(A)("VISITOR_TYPE",o.type,"color")},{default:a(()=>[_(h(f(A)("VISITOR_TYPE",o.type)),1)]),_:2},1032,["color"]))],64)):t.key==="action"?(s(),p(c,{key:3},[v[o.id]?(s(),p(c,{key:0},[e(x,{type:"link",size:"small",onClick:b=>G(o.id,k)},{default:a(()=>[_("保存")]),_:2},1032,["onClick"]),e(x,{type:"link",size:"small",onClick:b=>J(o.id,k)},{default:a(()=>[_("取消")]),_:2},1032,["onClick"])],64)):(s(),y(x,{key:1,type:"link",size:"small",onClick:b=>X(o.id)},{default:a(()=>[_("编辑")]),_:2},1032,["onClick"]))],64)):I("",!0)]),footer:a(()=>[e(x,{block:"",type:"dashed",onClick:Q},{icon:a(()=>[e(f(be))]),default:a(()=>[_(" 添加 ")]),_:1})]),_:1},8,["data-source"])]),_:1}),C("div",{class:"brevity-advanced-form-footer",style:xe({width:`calc(100% - ${f(M).marginLeft}px)`})},[ye,C("div",ke,[e(ne,{title:"校验提示"},{content:a(()=>[e(le,{size:"small","data-source":S.value,class:"brevity-advanced-form-footer-warn"},{renderItem:a(({item:t})=>[e(te,null,{default:a(()=>[e(f(q),{class:"error mr12"}),C("div",he,[(s(!0),p(c,null,R(t.errors,(g,o)=>(s(),p("div",{key:o},h(g),1))),128))])]),_:2},1024)]),_:1},8,["data-source"])]),default:a(()=>[S.value.length>0?(s(),y(f(q),{key:0,class:"error mr12"})):I("",!0)]),_:1}),e(x,{type:"primary","html-type":"submit",class:"mr12"},{default:a(()=>[_("确定")]),_:1}),e(x,null,{default:a(()=>[_("取消")]),_:1})])],4)]),_:1},8,["model"])],64)}}});export{na as default};
